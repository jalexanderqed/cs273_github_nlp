following code hangs forever after 10-30minutes

```
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <pthread.h>
#include "rocksdb/c.h"

typedef struct {
        rocksdb_t *db;
        rocksdb_writeoptions_t *woptions;
        rocksdb_readoptions_t *roptions;
} rocksdb_data_t;

size_t create_random_key(char *prefix, size_t prefix_size, char *key, size_t key_size)
{
        memcpy(key, prefix, prefix_size);
        for (size_t i = 0; i < key_size - prefix_size; i++) {
                key[prefix_size + i] = rand() % 255;
        }

        return key_size;
}

void *write_thread(void *arg) {
        rocksdb_data_t *data = (rocksdb_data_t *)arg;

        while (1) {
                char key[16];
                size_t key_size = create_random_key("wt", 2, key, sizeof(key));

                char *err_str = NULL;
                rocksdb_put(data->db, data->woptions, key, key_size, "test1234", 8, &err_str);
                if (err_str) {
                        fprintf(stderr, "rocksdb_put error: %s\n", err_str);
                        free(err_str);
                }
                usleep(rand() % 1000);
        }
}
int main() {
        rocksdb_options_t *options = rocksdb_options_create();
        rocksdb_options_set_create_if_missing(options, 1);
        rocksdb_options_enable_statistics(options);

        rocksdb_env_t *env = rocksdb_create_default_env();
        rocksdb_env_set_high_priority_background_threads(env, 2);
        rocksdb_env_set_background_threads(env, 2);

        rocksdb_options_set_env(options, env);
        rocksdb_options_set_max_background_flushes(options, 2);
        //rocksdb_options_set_max_background_compactions(options, 1);
        rocksdb_options_set_disable_auto_compactions(options, 1);

        rocksdb_options_set_write_buffer_size(options, 64 * 1024 * 1024);
        rocksdb_options_set_max_write_buffer_number(options, 8);
        rocksdb_options_set_max_log_file_size(options, 1 * 1024 * 1024 * 1024);
        rocksdb_options_set_keep_log_file_num(options, 5);
        rocksdb_options_set_log_file_time_to_roll(options, 0);

        char *err_str = NULL;
        rocksdb_t *db = rocksdb_open(options, "/tmp/test_storage", &err_str);
        if (err_str) {
                fprintf(stderr, "rocksdb_open error: %s\n", err_str);
                free(err_str);
                exit(1);
        }
        rocksdb_data_t data;
        data.db = db;
        data.woptions = rocksdb_writeoptions_create();
        data.roptions = rocksdb_readoptions_create();

        pthread_t wthreads[30];
        for (size_t i = 0; i < sizeof(wthreads) / sizeof(wthreads[0]); i++) {
                pthread_create(&wthreads[i], NULL, write_thread, &data);
        }

        void *result;
        pthread_join(wthreads[0], &result);
}

```

gdb output:

```

Thread 35 (Thread 0x7ff06d230700 (LWP 22361)):
#0  0x00007ff06d5ec0af in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
#1  0x000000000052b9c7 in rocksdb::ThreadPool::BGThread (this=this@entry=0xe6ba90, thread_id=thread_id@entry=0) at util/thread_posix.cc:68
#2  0x000000000052bbf3 in rocksdb::BGThreadWrapper (arg=0xe76440) at util/thread_posix.cc:143
#3  0x00007ff06d5e80db in start_thread () from /lib64/libpthread.so.0
#4  0x00007ff06d31890d in clone () from /lib64/libc.so.6

.....

Thread 31 (Thread 0x7ff06b22c700 (LWP 22365)):
#0  0x00007ff06d5ec0af in pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
#1  0x00007ff06ddcaa2c in std::condition_variable::wait(std::unique_lock<std::mutex>&) () from /usr/lib64/libstdc++.so.6
#2  0x00000000004edeac in wait<rocksdb::WriteThread::BlockingAwaitState(rocksdb::WriteThread::Writer*, uint8_t)::__lambda4> (__p=..., __lock=..., this=0x7ff06b22ba80) at /usr/include/c++/4.8/condition_variable:93
#3  rocksdb::WriteThread::BlockingAwaitState (this=<optimized out>, w=0x7ff06b22ba00, goal_mask=<optimized out>) at db/write_thread.cc:37
#4  0x00000000004edf7d in rocksdb::WriteThread::AwaitState (this=this@entry=0xe77188, w=w@entry=0x7ff06b22ba00, goal_mask=goal_mask@entry=14 '\016',
    ctx=ctx@entry=0x7ff3e0 <rocksdb::WriteThread::JoinBatchGroup(rocksdb::WriteThread::Writer*)::ctx>) at db/write_thread.cc:157
#5  0x00000000004ee274 in rocksdb::WriteThread::JoinBatchGroup (this=this@entry=0xe77188, w=w@entry=0x7ff06b22ba00) at db/write_thread.cc:227
#6  0x00000000004844a2 in rocksdb::DBImpl::WriteImpl (this=0xe76ca0, write_options=..., my_batch=<optimized out>, callback=callback@entry=0x0) at db/db_impl.cc:4201
#7  0x00000000004861a4 in rocksdb::DBImpl::Write (this=<optimized out>, write_options=..., my_batch=<optimized out>) at db/db_impl.cc:4155
#8  0x0000000000486234 in rocksdb::DB::Put (this=this@entry=0xe76ca0, opt=..., column_family=0xe84550, key=..., value=...) at db/db_impl.cc:5297
#9  0x0000000000486281 in rocksdb::DBImpl::Put (this=this@entry=0xe76ca0, o=..., column_family=<optimized out>, key=..., val=...) at db/db_impl.cc:4130
#10 0x000000000048654a in rocksdb::DB::Put (this=0xe76ca0, options=..., key=..., value=...) at ./include/rocksdb/db.h:185
#11 0x0000000000457ea7 in rocksdb_put (db=<optimized out>, options=<optimized out>, key=<optimized out>, keylen=<optimized out>, val=<optimized out>, vallen=<optimized out>, errptr=0x7ff06b22bd28) at db/c.cc:641
#12 0x0000000000456fb1 in write_thread (arg=0x7fff22013fb0) at test.c:35
#13 0x00007ff06d5e80db in start_thread () from /lib64/libpthread.so.0
#14 0x00007ff06d31890d in clone () from /lib64/libc.so.6
```

