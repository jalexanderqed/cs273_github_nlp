Fixes #1296 

Since these memtable_factories are shared_ptrs, whenever options is destroyed the static pointer becomes invalid. Any further use of these functions uses an invalid pointer. I eliminated this pattern from the C api, since there isn't much benefit to this in the first place.

 I also added a test that fails without the fix. I don't know if it's to trivial to include, though.

