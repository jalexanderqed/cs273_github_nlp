@rven1 @siying @igorcanadi Attempt number two. My apologies for a wrong fix first. Please, review.

